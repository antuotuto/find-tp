{"version":3,"file":"find.js","sources":["../../src/es/util.js","../../src/es/dom.js","../../src/es/find.js"],"sourcesContent":["\nexport function extend(target, source) {\n    for (var key in source) {\n        target[key] = source[key];\n    }\n}\n\n\nexport function trim(x) {\n    return x.replace(/^[\\r\\n]+/, '').replace(/[\\r\\n]+$/, '')\n}\n\n\nexport function isContains(str, substr) {\n    return new RegExp(substr).test(str);\n}\n","// dom\n\nexport function offset(el) {\n    let left = 0;\n    let top = 0;\n\n    while (el) {\n        left -= el.offsetLeft;\n        top -= el.offsetTop;\n        el = el.offsetParent;\n    }\n\n    return {\n        left,\n        top\n    }\n}\n","// import data from './data'\nimport {\n    extend,\n    trim,\n    isContains\n} from './util'\n\nimport {\n    offset\n} from './dom'\n\n\nclass Find {\n    constructor(wrapper, scroller, options) {\n        this.$wrapper = typeof wrapper === 'string' ? $(wrapper) : wrapper;\n        this.$scroller = typeof scroller === 'string' ? $(scroller) : scroller;\n        this.options = {\n            form: '#formFind',\n            text: '#textFind'\n        }\n        extend(this.options, options);\n\n        let formFind = this.options.form;\n        this.$formFind = typeof formFind === 'string' ? $(formFind) : formFind;\n        let textFind = this.options.text;\n        this.$textFind = typeof textFind === 'string' ? $(textFind) : textFind;\n\n        this._init()\n    }\n\n    _init() {\n        self = this;\n\n        this.stack = [];\n        this.stackIndex = 0;\n\n        this.$treeTitle = $('#advisorTreeVendorPanel .tree-title')\n\n        this._addEvents();\n    }\n\n    _addEvents() {\n        this.$textFind.on('change', this._handleEvent)\n        this.$formFind.on('submit', this._handleEvent)\n    }\n\n    _handleEvent(event) {\n        switch (event.type) {\n            case 'change':\n                self.onSearch(event);\n                break;\n            case 'submit':\n                event.preventDefault();\n                self.move(event);\n                break\n        }\n    }\n\n    onSearch() {\n        // reset\n        this.stack = [];\n        this.stackIndex = -1;\n\n        let val = this.$textFind.val()\n        console.log(val)\n\n        if (val != '') {\n            this.$treeTitle.each(function (index, domEle) {\n                let str = trim($(domEle).text()).toLowerCase();\n                let substr = trim(val).toLowerCase();\n                if (isContains(str, substr)) {\n                    self.stack.push(domEle)\n                }\n            })\n        }\n\n        this.render()\n        this.move()\n    }\n\n    render(event) {\n        $('.find-item').removeClass('find-item')\n        $('.find-item-active').removeClass('find-item-active')\n\n        $.each(this.stack, function (index, item) {\n            $(item).addClass('find-item')\n        })\n    }\n\n    move(event) {\n\n        if (!this.stack[0]) {\n            return\n        }\n\n        this.stackIndex < this.stack.length - 1 ? ++this.stackIndex : this.stackIndex = 0;\n\n        $('.find-item-active').removeClass('find-item-active');\n        $(this.stack[this.stackIndex]).addClass('find-item-active');\n\n        let deltaTop = $(this.stack[this.stackIndex]).offset().top - this.$wrapper.offset().top;\n        if (deltaTop < 0 || deltaTop >= this.$wrapper.height()) {\n            console.log(deltaTop)\n            this.$wrapper.scrollTop($(this.stack[this.stackIndex]).position().top)\n        }\n\n    }\n\n}\n\n\nwindow.Find = Find\n\nexport default Find\n"],"names":["extend","target","source","key","trim","x","replace","isContains","str","substr","RegExp","test","Find","wrapper","scroller","options","$wrapper","$","$scroller","formFind","form","$formFind","textFind","text","$textFind","_init","stack","stackIndex","$treeTitle","_addEvents","on","_handleEvent","event","type","onSearch","preventDefault","move","val","log","each","index","domEle","toLowerCase","push","render","removeClass","item","addClass","length","deltaTop","offset","top","height","scrollTop","position","window"],"mappings":"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"}